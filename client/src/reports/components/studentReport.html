<template>
  <require from="../converters/scoreFilter"></require>
  <require from="../../shared/converters/dateFormat"></require>
  <require from="../../shared/converters/scoreFormat"></require>

  <!-- Selection Menu -->
  <div class="row">
    <form class="form-inline" submit.delegate="generate()">
      <div class="form-group">
        <label>Select Student:</label>
        <select class="form-control" value.bind="selected.student" placeholder="Select Student">
          <option repeat.for="student of students" model.bind="student">
            ${ student.first_name } ${ student.last_name }
          </option>
        </select>
      </div>
      <div class="form-group">
        <label>Start Date:</label>
          <input type="date" class="form-control" value.bind="selected.start">
      </div>

      <div class="form-group">
        <label>End Date:</label>
          <input type="date" class="form-control" value.bind="selected.end">
      </div>

      <button type="submit" class="btn btn-default">Generate Report</button>
      <ul>
    </form>
  </div>

  <!-- Report Header -->
  <div if.bind="reportGenerated">
  <div class="row">
    <h1>${ selected.student.first_name & oneTime} ${ selected.student.last_name & oneTime}</h1>
  </div>

  <!-- Subject Rows -->
  <div class="row" repeat.for="subject of current.subjectList">
    <div class="col-md-6">
      <h2>${ subject.name & oneTime}</h2>
      <table class="table">
        <thead>
          <th></th>
          <th>Date</th>
          <th>Max Score</th>
          <th>Score</th>
        </thead>
        <tbody>
          <tr repeat.for="score of scores | scoreFilter: subject.id">
            <td>${ score.assref.name & oneTime}</td>
            <td>${ score.assref.date | dateFormat: 'MMMM Do' & oneTime}</td>
            <td>${ score.assref.max & oneTime}</td>
            <td innerhtml.bind="score.value | scoreFormat: score.assref & oneTime"></td>
          </tr>
        </tbody>
      </table>
    </div>
  </div>
</div>
</template>
